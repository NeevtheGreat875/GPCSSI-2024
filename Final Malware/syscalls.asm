.data
extern NtOpenProcessSSN:DWORD
extern NtVirtualAllocSSN:DWORD
extern NtWriteMemSSN:DWORD
extern NtCreateThreadSSN:DWORD
extern NtWaitForSSN:DWORD
extern NtCloseSSN:DWORD
extern NtProtectVirtualMemorySSN:DWORD
extern NtSyscallAddr:QWORD

.code
NtOpenProcess proc
	mov r10, rcx
	mov eax, NtOpenProcessSSN
	jmp qword ptr NtSyscallAddr
	ret
NtOpenProcess endp

NtAllocateVirtualMemory proc
	mov r10, rcx
	mov eax, NtVirtualAllocSSN
	jmp qword ptr NtSyscallAddr
	ret
NtAllocateVirtualMemory endp

NtWriteVirtualMemory proc
	mov r10, rcx
	mov eax, NtWriteMemSSN
	jmp qword ptr NtSyscallAddr
	ret
NtWriteVirtualMemory endp

NtProtectVirtualMemory proc
	mov r10, rcx
	mov eax, NtProtectVirtualMemorySSN
	jmp qword ptr NtSyscallAddr
	ret
NtProtectVirtualMemory endp

NtCreateThreadEx proc
	mov r10, rcx
	mov eax, NtCreateThreadSSN
	jmp qword ptr NtSyscallAddr
	ret
NtCreateThreadEx endp

NtWaitForSingleObject proc
	mov r10, rcx
	mov eax, NtWaitForSSN
	jmp qword ptr NtSyscallAddr
	ret
NtWaitForSingleObject endp

NtClose proc
	mov r10, rcx
	mov eax, NtCloseSSN
	jmp qword ptr NtSyscallAddr
	ret
NtClose endp

END